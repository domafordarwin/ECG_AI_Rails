<% content_for :title, "ECG EduLink - My Records" %>

<header class="bg-white border-b border-gray-200 sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
    <div class="flex items-center gap-2 cursor-pointer" onclick="window.location.href='/'">
      <div class="text-[#1e3a8a]">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z"></path>
        </svg>
      </div>
      <span class="text-xl font-bold text-slate-900 tracking-tight">ECG EduLink</span>
    </div>
    <nav class="hidden md:flex space-x-8 h-full">
      <a class="inline-flex items-center px-1 pt-1 text-sm font-medium text-gray-500 hover:text-gray-700" href="/">Dashboard</a>
      <a class="inline-flex items-center px-1 pt-1 text-sm font-medium text-gray-500 hover:text-gray-700" href="/upload">Upload</a>
      <a class="inline-flex items-center px-1 pt-1 text-sm font-medium text-blue-800 border-b-2 border-blue-800" href="/history">My Records</a>
      <a class="inline-flex items-center px-1 pt-1 text-sm font-medium text-gray-500 hover:text-gray-700" href="/feedback">Feedback</a>
    </nav>
    <div class="flex items-center">
      <button class="bg-gray-200 rounded-full p-2 text-gray-500">
        <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M18.685 19.097A9.723 9.723 0 0021.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 003.065 7.097A9.716 9.716 0 0012 21.75a9.716 9.716 0 006.685-2.653zm-12.54-1.285A7.486 7.486 0 0112 15a7.486 7.486 0 015.855 2.812A8.224 8.224 0 0112 20.25a8.224 8.224 0 01-5.855-2.438zM15.75 9a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" fill-rule="evenodd"></path></svg>
      </button>
    </div>
  </div>
</header>

<main class="flex-grow max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <h1 class="text-3xl font-bold text-slate-900 mb-6">My Records (History)</h1>
  
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
    <div class="p-6 lg:p-8 flex flex-col lg:flex-row gap-8 lg:gap-12 text-slate-800">
      <!-- Left Column: Timeline -->
      <section class="lg:w-1/3 relative">
        <h2 class="text-lg font-bold text-slate-900 mb-6">Timeline of Uploaded Records</h2>
        <div class="flex flex-col space-y-4 relative">
          <div class="absolute left-[15px] top-6 bottom-6 w-[2px] bg-gray-300 z-0"></div>
          
          <div class="relative pl-10">
            <div class="absolute left-1 top-6 w-6 h-6 rounded-full bg-white border-2 border-blue-600 shadow-sm flex items-center justify-center z-10"><div class="w-3 h-3 bg-blue-600 rounded-full"></div></div>
            <div class="bg-blue-50 border border-blue-500 rounded-lg p-4 shadow-sm cursor-pointer">
              <h3 class="font-bold text-slate-900 text-sm">Oct 26, 2023 - ECG Lab 3 (Post-Exercise)</h3>
              <p class="text-sm text-slate-700 mt-1">v2: Improvement</p>
              <p class="text-sm text-slate-600 mt-1 font-semibold">Status: Feedback Completed</p>
            </div>
          </div>

          <% 2.times do |i| %>
            <div class="relative pl-10">
              <div class="absolute left-1 top-6 w-6 h-6 rounded-full bg-white border-2 border-gray-300 z-10"></div>
              <div class="bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors cursor-pointer">
                <h3 class="font-bold text-slate-900 text-sm">Oct <%= 24 - (i*9) %>, 2023 - Lab <%= 3-i %></h3>
                <p class="text-sm text-slate-700 mt-1">v1: Initial Upload</p>
                <p class="text-sm text-slate-600 mt-1">Status: Feedback Completed</p>
              </div>
            </div>
          <% end %>
        </div>
      </section>

      <!-- Right Column: Comparison -->
      <section class="lg:w-2/3 flex flex-col h-full">
        <h2 class="text-lg font-bold text-slate-900 mb-6">Compare This Measurement vs. Last Measurement</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
          <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-6">
            <h3 class="text-sm text-slate-600 font-medium mb-1">Heart Rate (BPM)</h3>
            <div class="flex items-end justify-between">
              <div>
                <div class="text-4xl font-bold text-slate-900">78</div>
                <div class="flex items-center mt-2 text-green-600 text-sm font-semibold">
                  <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M5 10l7-7m0 0l7 7m-7-7v18" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
                  6 BPM Up
                </div>
              </div>
              <img src="https://cdn-icons-png.flaticon.com/512/3209/3209106.png" class="h-12 w-auto opacity-50" alt="Graph">
            </div>
          </div>
          <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-6">
            <h3 class="text-sm text-slate-600 font-medium mb-1">QRS Duration (ms)</h3>
            <div class="flex items-end justify-between">
              <div>
                <div class="text-4xl font-bold text-slate-900">92</div>
                <div class="flex items-center mt-2 text-slate-400 text-sm font-semibold">No Change</div>
              </div>
              <img src="https://cdn-icons-png.flaticon.com/512/3209/3209106.png" class="h-12 w-auto opacity-50" alt="Graph">
            </div>
          </div>
        </div>
        
        <div class="mt-auto">
          <h3 class="text-lg font-bold text-slate-900 mb-4">Submission Status & Feedback Details</h3>
          <div class="space-y-4 mb-6">
            <div class="flex items-center gap-2">
              <svg class="h-5 w-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
              <span class="text-sm font-bold">Teacher Confirmed:</span>
              <span class="text-sm text-slate-600">Yes (Prof. Davis, Oct 27)</span>
            </div>
          </div>
          <button class="w-full bg-blue-50 hover:bg-blue-100 text-blue-800 font-bold py-3 px-4 rounded-lg border border-blue-200 transition-colors" onclick="window.location.href='/feedback'">
            View Full Feedback & Analysis
          </button>
        </div>
      </section>
    </div>
  </div>
</main>
